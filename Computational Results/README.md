# Angular Deviation Diffuser: An Angular Deviation-Based Diffusion Model for Efficient Protein Conformational Ensemble Generation
## Abstract:
Protein functionality is inherently tied to its structure, with both static and dynamic conformations playing critical roles in defining biological activity. While molecular dynamics (MD) simulations have long been the standard for exploring protein dynamics, they come with high computational costs and limited sampling efficiency. Recent advances in deep learning, such as AlphaFold, have significantly improved static protein structure prediction, yet accurately generating the dynamic ensemble of protein conformations remains a complex challenge. In this study, we present a transformer-based diffusion model that generates diverse conformational ensembles of protein backbones by utilizing angular deviations as data flow. Our model combines a cutting-edge diffusion model with the principles of SE(3) symmetry to enhance both the accuracy and efficiency of conformational sampling. Applied to the Vivid (VVD) Photoreceptor protein system, the generated ensembles closely align with those from MD simulations while covering a broader range of conformational states. This approach offers an improved methodology for capturing protein dynamics, contributing to a more comprehensive understanding of protein structure and function.
### Keywords: angular deviation, diffusion model, the three-dimensional (3D) structure, molecular dynamics (MD) simulation, the Vivid (VVD) Photoreceptor protein

### Presentation Slide: [Google Drive](https://docs.google.com/presentation/d/1Q__65vTskoqPcXgiTq0xRhqN3LCyFN8V/edit?usp=sharing&ouid=101767369176883618869&rtpof=true&sd=true).
### Manuscript available at [bioRxiv](https://www.biorxiv.org/content/10.1101/2025.03.03.640492v1.full.pdf).
# Computational Results shown in figures

This README file provides descriptions for all the figures included in this repository to aid in understanding their context and purpose. Each figure is associated with a specific aspect of the study and has been organized sequentially.

## Main Figures
### Figure 1: Overview of Our Work
This figure provides a comprehensive overview of our research workflow, summarizing the major steps and key methodologies used.

![Angular Deviation Diffuser Workflow](https://github.com/AlanYangYi/angular_deviation_diffuser/blob/2db3939e7b49b2c8b821c8dd9ac6b1210c9f8f50/Pictures/overview.png)


### Figure 2: Six Angle Types of the Protein Backbone
This figure illustrates the six types of angles in the protein backbone. Bond angles are shown in light green, while dihedral angles are depicted in dark green.

![Figure2](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/Figure2.svg).


### Figure 3: Using Angle Deviation vs. Absolute Angles
- **(a):** Comparison of the proportion of correctly folded structures generated using absolute angles versus angular deviation.
![Figure3a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure3a.svg).
- **(b):** Comparison of RMSD area under the curve and JS divergence between generated angle distributions and MD simulation angle distributions.
![Figure3b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure3b.svg).


### Figure 4: Angle Distributions Between Generated Structures and MD Simulation
- **(a):** Dark state system.
  ![Figure4a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/Figure4a.svg).
- **(b):** Light state system.
  ![Figure4a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/Figure4b.svg).
This figure showcases the distributions of the six angle types for both systems.

### Figure 5: Ramachandran Plot of Generated Ensembles
- **(a):** Dark state system.
  ![Figure5a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure5a.svg).
- **(b):** Light state system.
 ![Figure5b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure5b.svg).
These plots visualize the generated ensembles' backbone dihedral angles.

### Figure 6: RMSD Distributions with Training Set
The x-axis represents the RMSD for the dark state, while the y-axis represents the RMSD for the light state. This figure shows how closely the generated structures align with the training data.

![Figure6](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure6.svg).


### Figure 7: Pairwise RMSD Distributions for Five Conformational Ensembles
This figure compares five distinct ensembles:
1. Training set.
2. Structures generated by our model without refinement.
3. Structures generated by our model with refinement.
4. A new MD simulation.
5. Structures generated using AlphaFold Flow.

- **(a):** Dark state system.
 ![Figure7a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure7a.svg).
  
- **(b):** Light state system.
  ![Figure7b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure7b.svg).
- These pairwise distributions show how the generated ensembles align with the original MD simulation ensemble.

### Figure 8: Two MD Simulation Systems
This figure illustrates the two MD simulation systems:
- Dark state system (PDB ID 2pd7).
- Light state system (PDB ID 3rh8).
![Figure8](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure8.svg).
### Figure 9: Denoising Process Using Angles and Angle Deviations
- **(a):** Using angle deviations.
  ![Figure9a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure9a.svg).
- **(b):** Using absolute angles.
  ![Figure9b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/figure9b.svg).
This figure depicts shifts in angle distributions and conformational changes during the denoising process for the dark state system.

## Supplementary Figures

### Figure S1: Dark and Light State MD Simulations
- **(a):** RMSD regarding the first frame and RMSF regarding the averaged conformation for each system.
  ![FigureS1a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/supplement_figure1a.svg).
- **(b):** Ramachandran plot for each system.
![FigureS1b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/supplement_figure1b.svg).
### Figure S2: Comparison of Generated vs. Refined Conformations
This figure compares the directly generated conformations to those refined through RMSD. Light-colored structures correspond to conformations before refinement, while dark-colored structures represent refined conformations.
![FigureS2](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/supplement_figure2.svg).
### Figure S3: Angle Distribution Changes During Denoising
- **(a):** Using absolute angles as data flow.
  ![FigureS3a](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/supplement_figure3a.svg).
- **(b):** Using angle deviation as data flow.
  ![FigureS3b](https://github.com/AlanYangYi/Angular_Deviation_Diffuser/blob/main/Computational%20Results/supplement_figure3b.svg).
This figure highlights how the angle distributions evolve during the denoising process for the dark state system.




